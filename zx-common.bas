' VARIABLES
LET Z=0
LET Y=1
LET A=Z
LET T=Z
LET V=13
LET C=44
LET D=Z
LET E=Z
LET R=Z
LET X=2
LET I=Z
LET J=Z
DIM A(45)
LET G=100
LET H=4
LET K=512
LET L=32
LET U=16
LET N=255
LET O=99
LET F=65535
LET Q=6
LET S=3841
LET B=4096
LET M=39
LET P=Y
LET W=Z
FOR I=Z TO C
READ A(I)
NEXT I
PRINT "WELCOME TO THE BATTLE SYSTEM TEST!"
PRINT
PRINT
_350:
PRINT "TWO SOLDIERS APPROACH."
PRINT
_370:
' MAIN LOOP
IF A((V*A)+Y)=Z THEN GOTO _420
IF A=Z THEN GOTO _780
LET T=Z
GOTO _1190
_420:
' ITERATE ATTACKER
IF A(Y)=Z THEN GOTO _2410
LET A=A+Y
IF A<>Z THEN LET T=Z
IF A((V*A)+Y)=Z THEN LET A=A+Y
IF A>X THEN LET A=Z
LET D=Z
IF A((V*Y)+Y)=Z THEN LET D=D+Y
IF A((V*X)+Y)=Z THEN LET D=D+Y
IF D=X THEN GOTO _530
GOTO _370
_530:
' NEW GAME
PRINT "YOU ARE VICTORIOUS."
PRINT
LET W=W+Y
LET A=Z
LET T=Z
IF W>=10 THEN GOSUB _690
FOR I=Y TO X
LET A((I*V)+Y)=A((I*V+Y)+Y)
NEXT I
GOSUB _2090
IF R<12.5 THEN PRINT "YOU OBTAINED A POTION!"
IF R<12.5 THEN PRINT
IF R<12.5 THEN LET P=P+Y
IF P>O THEN LET P=O
GOTO _350
_690:
' INCREASE DIFFICULTY
GOSUB _2090
IF R>=25 THEN RETURN
FOR I=V TO M-Y
LET A(I+Y)=A(I+Y)*1.5
NEXT I
PRINT "THE ENEMIES HAVE POWERED UP!"
PRINT
RETURN
_780:
' MENU LOOP
PRINT
PRINT A(Y);"/";A(X);"HP"
PRINT A(3);"/";A(H);"MP"
PRINT
PRINT "(A) ATTACK"
PRINT "(M) MAGIC"
PRINT "(I) ITEMS"
PRINT "(Q) QUIT"
_870:
LET A$=INKEY$
IF A$="" THEN GOTO _870
IF A$="A" OR A$="a" THEN GOTO _930
IF A$="M" OR A$="m" THEN GOTO _990
IF A$="I" OR A$="i" THEN GOTO _1100
IF A$="Q" OR A$="q" THEN GOTO _2480
GOTO _780
_930:
' ATTACK INPUT ROUTINE
GOSUB _2120
IF C=Z THEN GOTO _780
IF C>X THEN GOTO _930
IF C<Z THEN GOTO _930
GOTO _1190
_990:
' MAGIC INPUT ROUTINE
PRINT
PRINT "(1) LIGHTNING -";A(M+Y);"MP"
PRINT "(2) CURE -";A(M+H);"MP"
PRINT "WHICH SPELL DO YOU WANT TO CAST?"
PRINT "TYPE (0) TO GO BACK."
_1050:
LET A$=INKEY$
IF A$="" THEN GOTO _1050
LET C=VAL A$
IF C=Y THEN GOTO _1630
IF C=X THEN GOTO _1850
IF C=Z THEN GOTO _780
GOTO _990
_1100:
' ITEM ROUTINE
PRINT
PRINT "(1) POTION -";P
PRINT "WHICH ITEM DO YOU WISH TO USE?"
PRINT "TYPE (0) TO GO BACK."
_1150:
LET A$=INKEY$
IF A$="" THEN GOTO _1150
LET C=VAL A$
IF C=Y THEN GOTO _1980
IF C=Z THEN GOTO _780
GOTO _1100
_1190:
' ATTACK ROUTINE
LET C=((A((A*V+10)+Y)/H)+(A((A*V+5)+Y)))+A((A*V+7)+Y)-A((T*V+7)+Y)
GOSUB _2090
LET I=A((A*V+11)+Y)
GOSUB _2270
IF D>R THEN LET C=N
LET I=A((T*V+11)+Y)
GOSUB _2270
IF D>R THEN LET C=N
IF R<C THEN GOTO _1330
IF T>Z THEN PRINT "YOUR ATTACK MISSED!"
IF T=Z THEN PRINT "SOLDIER";A;"MISSED YOU!"
PRINT
GOTO _420
_1330:
' PHYSICAL DAMAGE ROUTINE
LET D=A((A*V+H)+Y)
LET E=A((A*V+12)+Y)
LET C=D+((D+E)/L)*((D*E)/L)
LET D=((U*(K-A((T*V+Q)+Y)))*C)/(U*K)
LET C=(A((A*V+11)+Y)+A((A*V+12)+Y)-A((T*V+12)+Y))/H
GOSUB _2300
IF R<=C THEN GOTO _1420
GOTO _1440
_1420:
' CRITICAL HIT DAMAGE
LET TE=D*X
LET D=INT TE
_1440:
' RANDOM DAMAGE VARIATION
LET TE=D*(S+(RND*N))/B
LET D=INT TE
IF D=Z THEN LET D=Y
LET A((T*V)+Y)=A((T*V)+Y)-D
IF A((T*V)+Y)<=Z THEN LET A((T*V)+Y)=Z
IF A<>Z THEN GOTO _1560
PRINT "YOU HIT SOLDIER";T;"FOR";D;"HP."
PRINT
IF A((T*V)+Y)<>Z THEN GOTO _1550
PRINT "YOU DEFEATED SOLDIER";T
PRINT
_1550:
GOTO _420
_1560:
IF D>Z THEN GOSUB _2330
PRINT "SOLDIER";A;"HIT YOU FOR";D;"HP."
PRINT
IF A(Y)<>Z THEN GOTO _1620
PRINT "YOU DIED."
PRINT
_1620:
GOTO _420
_1630:
' LIGHTNING ROUTINE
LET E=Z
LET D=Z
IF A(M+Y)>A(3) THEN GOTO _1810
LET A(3)=A(3)-A(M+Y)
GOSUB _2120
IF C=Z THEN GOTO _990
IF C>X THEN GOTO _1630
IF C<Z THEN GOTO _1630
LET C=A(M+3)+A((A*V+12)+Y)-((A((T*V+12)+Y))/X)-Y
GOSUB _2090
IF R<C THEN GOSUB _2380
IF R>C THEN GOTO _1770
LET D=(A(M+X)*(K-A((T*V+9)+Y))*C)/(U*K)
_1770:
IF D>Z THEN GOTO _1440
PRINT "YOUR SPELL MISSED."
PRINT
GOTO _420
_1810:
' NOT ENOUGH MP ROUTINE
PRINT
PRINT "YOU DON'T HAVE ENOUGH MP TO CAST THAT SPELL."
GOTO _990
_1850:
' CURE ROUTINE
LET E=3
IF A(M+H)>A(3) THEN GOTO _1810
LET A(3)=A(3)-A(M+H)
GOSUB _2380
LET D=C+22*A(M+Y+E+Y)
LET TE=D*(S+(RND*N))/B
LET D=INT TE
PRINT
PRINT "YOU HAVE BEEN HEALED FOR";D;"HP."
PRINT
LET A(Y)=A(Y)+D
IF A(Y)>A(X) THEN LET A(Y)=A(X)
GOTO _420
_1980:
' ITEM ROUTINE
IF P=Z THEN PRINT
IF P=Z THEN PRINT "YOU HAVE NO POTIONS."
IF P=Z THEN GOTO _780
LET A(Y)=A(Y)+G
IF A(Y)>A(X) THEN LET A(Y)=A(X)
LET P=P-Y
PRINT
PRINT "YOU HAVE BEEN HEALED FOR 100 HP."
PRINT
GOTO _420
_2090:
' RANDOM 100 ROUTINE
LET TE=RND*G
LET R=INT TE
RETURN
_2120:
' SHARED INPUT ROUTINE
PRINT
FOR I=Y TO X
IF A((V*I)+Y)>Z THEN PRINT "(";I;")";" SOLDIER";I
NEXT I
PRINT "WHICH ENEMY DO YOU WANT TO TARGET?"
PRINT "(0) TO GO BACK."
_2190:
LET A$=INKEY$
IF A$="" THEN GOTO _2190
LET C=VAL A$
IF C=Z THEN RETURN
LET E=Z
IF A((V*C)+Y)<=Z THEN LET E=N
IF E=N THEN GOTO _2120
LET T=C
PRINT
RETURN
_2270:
' LUCKY HIT ROUTINE
LET D=I/H
RETURN
_2300:
' RANDOM 65535 ROUTINE
LET R=((RND*F)*O/F)+Y
RETURN
_2330:
' DING ROUTINE
FOR J=Z TO G
NEXT J
' DING!
RETURN
_2380:
' MAGIC DAMAGE ROUTINE
LET C=Q*(A(9)+A(V))
RETURN
_2410:
' GAME OVER ROUTINE
PRINT
PRINT "GAME OVER"
PRINT
FOR I=Z TO Y
GOSUB _2330
NEXT I
_2480:
PRINT
PRINT "YOU WON";W;"TIMES."
PRINT
STOP
#data
314
314
54
54
38
96
24
1
21
17
6
14
6
30
30
0
0
6
1
4
1
1
1
50
4
2
30
30
0
0
6
1
4
1
1
1
50
4
2
4
8
100
5
5
255
#enddata
